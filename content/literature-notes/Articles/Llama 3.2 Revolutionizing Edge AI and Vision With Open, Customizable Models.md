---
author: [[meta.com]]
title: "Llama 3.2: Revolutionizing Edge AI and Vision With Open, Customizable Models"
date: 2024-09-25
tags: 
- articles
- literature-note
---
![rw-book-cover](https://scontent-sjc3-1.xx.fbcdn.net/v/t39.2365-6/460993006_2920762584889879_5205653052963582511_n.png?_nc_cat=104&ccb=1-7&_nc_sid=e280be&_nc_ohc=ZQcnpDW25kMQ7kNvgGSUlLE&_nc_ht=scontent-sjc3-1.xx&_nc_gid=AVm2pLtxrlmSyKqSiWWXj7V&oh=00_AYCVENm9lVrIlw2MQ6R5R8VcvIk3pYtxkBXn7_OLMnGIYw&oe=670E8B3C)

## Metadata
- Author: [[meta.com]]
- Full Title: Llama 3.2: Revolutionizing Edge AI and Vision With Open, Customizable Models
- URL: https://ai.meta.com/blog/llama-3-2-connect-2024-vision-edge-mobile-devices/

## Highlights
- Today, we’re releasing Llama 3.2, which includes small and medium-sized vision LLMs (11B and 90B), and lightweight, text-only models (1B and 3B) that fit onto edge and mobile devices, including pre-trained and instruction-tuned versions. ([View Highlight](https://read.readwise.io/read/01j8ncvs2thjesx9tn4mzq6fxw))
- The Llama 3.2 1B and 3B models support context length of 128K tokens and are state-of-the-art in their class for on-device use cases like summarization, instruction following, and rewriting tasks running locally at the edge. These models are enabled on day one for Qualcomm and MediaTek hardware and optimized for Arm processors. ([View Highlight](https://read.readwise.io/read/01j8ncvz1s03w5wktr77tkea6x))
- Supported by a broad ecosystem, the Llama 3.2 11B and 90B vision models are drop-in replacements for their corresponding text model equivalents, while exceeding on image understanding tasks compared to closed models, such as Claude 3 Haiku. Unlike other open multimodal models, both pre-trained and aligned models are available to be fine-tuned for custom applications using torchtune and deployed locally using torchchat. They’re also available to try using our smart assistant, Meta AI. ([View Highlight](https://read.readwise.io/read/01j8ncw35hhzmmpvyv17gc0whc))
- We’re sharing the first official [Llama Stack](https://github.com/meta-llama/llama-stack) distributions, which will greatly simplify the way developers work with Llama models in different environments, including single-node, on-prem, cloud, and on-device, enabling turnkey deployment of retrieval-augmented generation (RAG) and tooling-enabled applications with integrated safety. ([View Highlight](https://read.readwise.io/read/01j8ncwsgxk07v2wsdgnxm010p))
- We’ve been working closely with partners like AWS, Databricks, Dell Technologies, Fireworks, Infosys, and Together AI to build Llama Stack distributions for their downstream enterprise clients. On-device distribution is via PyTorch [ExecuTorch](https://github.com/pytorch/executorch), and single-node distribution is via Ollama. ([View Highlight](https://read.readwise.io/read/01j8ncx0d7zqkewppyw0yk3e4f))
- We’re making Llama 3.2 models available for download on [llama.com](https://llama.meta.com/) and [Hugging Face](https://huggingface.co/meta-llama), as well as available for immediate development on our broad ecosystem of partner platforms, including AMD, AWS, Databricks, Dell, Google Cloud, Groq, IBM, Intel, Microsoft Azure, NVIDIA, Oracle Cloud, Snowflake, and more. ([View Highlight](https://read.readwise.io/read/01j8ncx71g7msgyrr6cbxmc098))
- We’ve been excited by the [impact the Llama 3.1 herd of models have made](https://ai.meta.com/blog/llama-usage-doubled-may-through-july-2024/) in the two months since we announced them, including the [405B](https://www.meta.ai/?utm_source=llama_meta_site&utm_medium=web&utm_content=Llama_nav&utm_campaign=July_moment)—the first open frontier-level AI model. While these models are incredibly powerful, we recognize that building with them requires significant compute resources and expertise. We’ve also heard from developers who don’t have access to these resources and still want the opportunity to build with Llama. As Meta Founder and CEO Mark Zuckerberg shared today at Connect, they won’t have to wait any longer. Today, we’re releasing Llama 3.2, which includes small and medium-sized vision LLMs (11B and 90B) and lightweight, text-only models (1B and 3B) that fit onto select edge and mobile devices. ([View Highlight](https://read.readwise.io/read/01j8ncxk1hjx8fw9d73fr0h3dv))
- We’re making Llama 3.2 models available for download on [llama.com](https://llama.meta.com/) and [Hugging Face](https://huggingface.co/meta-llama), as well as available for immediate development on our broad ecosystem of partner platforms. Partners are an important part of this work, and we’ve worked with over 25 companies, including AMD, AWS, Databricks, Dell, Google Cloud, Groq, IBM, Intel, Microsoft Azure, NVIDIA, Oracle Cloud, and Snowflake, to enable services on day one. For the Llama 3.2 release, we’re also working with on-device partners Arm, MediaTek, and Qualcomm to offer a broad range of services at launch. Starting today, we’re also making [Llama Stack](https://github.com/meta-llama/llama-stack) available to the community. More details on the latest release, including information on the [multimodal availability](https://euneedsai.com/) in Europe, can be found in [our acceptable use policy](https://github.com/meta-llama/llama-models/blob/main/models/llama3_2/USE_POLICY.md). ([View Highlight](https://read.readwise.io/read/01j8ncy5dsbs12cph7h9985jmv))
- The two largest models of the Llama 3.2 collection, 11B and 90B, support image reasoning use cases, such as document-level understanding including charts and graphs, captioning of images, and visual grounding tasks such as directionally pinpointing objects in images based on natural language descriptions. For example, a person could ask a question about which month in the previous year their small business had the best sales, and Llama 3.2 can then reason based on an available graph and quickly provide the answer. In another example, the model could reason with a map and help answer questions such as when a hike might become steeper or the distance of a particular trail marked on the map. The 11B and 90B models can also bridge the gap between vision and language by extracting details from an image, understanding the scene, and then crafting a sentence or two that could be used as an image caption to help tell the story. ([View Highlight](https://read.readwise.io/read/01j8ncyd4s7fx48803wwvdzxbd))
- The lightweight 1B and 3B models are highly capable with multilingual text generation and tool calling abilities. These models empower developers to build personalized, on-device agentic applications with strong privacy where data never leaves the device. For example, such an application could help summarize the last 10 messages received, extract action items, and leverage tool calling to directly send calendar invites for follow-up meetings. ([View Highlight](https://read.readwise.io/read/01j8ncyk1y6dvqxt0qm6qe9k6a))
- Running these models locally comes with two major advantages. First, prompts and responses can feel instantaneous, since processing is done locally. Second, running models locally maintains privacy by not sending data such as messages and calendar information to the cloud, making the overall application more private. Since processing is handled locally, the application can clearly control which queries stay on the device and which may need to be processed by a larger model in the cloud. ([View Highlight](https://read.readwise.io/read/01j8ncypq828jkz0wd994zj7g8))
- Our evaluation suggests that the Llama 3.2 vision models are competitive with leading foundation models, Claude 3 Haiku and GPT4o-mini on image recognition and a range of visual understanding tasks. The 3B model outperforms the Gemma 2 2.6B and Phi 3.5-mini models on tasks such as following instructions, summarization, prompt rewriting, and tool-use, while the 1B is competitive with Gemma. ([View Highlight](https://read.readwise.io/read/01j8ncyvjv1vbb1np1gza7k8hf))
- As the first Llama models to support vision tasks, the 11B and 90B models required an entirely new model architecture that supports image reasoning. ([View Highlight](https://read.readwise.io/read/01j8ncz65qym5yypjx449ra9k3))
- To add image input support, we trained a set of adapter weights that integrate the pre-trained image encoder into the pre-trained language model. The adapter consists of a series of cross-attention layers that feed image encoder representations into the language model. We trained the adapter on text-image pairs to align the image representations with the language representations. During adapter training, we also updated the parameters of the image encoder, but intentionally did not update the language-model parameters. By doing that, we keep all the text-only capabilities intact, providing developers a drop-in replacement for Llama 3.1 models. ([View Highlight](https://read.readwise.io/read/01j8nczbvd2vp5czeqnsseje19))
- Our training pipeline consists of multiple stages, starting from pretrained Llama 3.1 text models. First, we add image adapters and encoders, then pretrain on large-scale noisy (image, text) pair data. Next, we train on medium-scale high quality in-domain and knowledge-enhanced (image, text) pair data. ([View Highlight](https://read.readwise.io/read/01j8nczqg50xr54e86k277dprg))
- In post-training, we use a similar recipe as the text models by doing several rounds of alignment on supervised fine-tuning, rejection sampling, and direct preference optimization. We leverage synthetic data generation by using the Llama 3.1 model to filter and augment question and answers on top of in-domain images, and use a reward model to rank all the candidate answers to provide high quality fine-tuning data. We also add safety mitigation data to produce a model with a high level of safety while retaining helpfulness of the mode ([View Highlight](https://read.readwise.io/read/01j8nczzv4qqma7z9kefds8bxs))
- The end result is a set of models that can take in both image and text prompts, and deeply understand and reason on the combination. This is another step toward Llama models having even richer agentic capabilities. ([View Highlight](https://read.readwise.io/read/01j8nd0hrbv3vzv4kfftqk1b8v))
- Knowledge distillation uses a larger network to impart knowledge on a smaller network, with the idea that a smaller model can achieve better performance using a teacher than it could from scratch. For the 1B and 3B in Llama 3.2, we incorporated logits from the Llama 3.1 8B and 70B models into the pre-training stage of the model development, where outputs (logits) from these larger models were used as token-level targets. Knowledge distillation was used after pruning to recover performance. ([View Highlight](https://read.readwise.io/read/01j8nd0q23rddt71ab2mxg0zkr))
- In post-training, we scale context length support to 128K tokens, while maintaining the same quality as the pre-trained model. We also engage in synthetic data generation that goes through careful data processing and filtering to ensure high quality. We carefully blend the data to optimize for high quality across multiple capabilities like summarization, rewriting, instruction following, language reasoning, and tool use. ([View Highlight](https://read.readwise.io/read/01j8nd0t8xggph8h181qmpaqg5))
- In July, we released a [request for comment](https://github.com/meta-llama/llama-stack/issues/6) on the Llama Stack API, a standardized interface for canonical toolchain components (fine-tuning, synthetic data generation) to customize Llama models and build agentic applications. The engagement has been great. ([View Highlight](https://read.readwise.io/read/01j8nd12pywk4q4tbdzgqkpnjf))
- Since then, we have been working hard to make the API real. We built a reference implementation of the APIs for inference, tool use, and RAG. In addition, we have been working with partners to adapt them to become providers for the APIs. Finally, we have introduced Llama Stack Distribution as a way to package multiple API Providers that work well together to provide a single endpoint for developers. We are now sharing with the community a simplified and consistent experience that will enable them to work with Llama models in multiple environments, including on-prem, cloud, single-node, and on-device. ([View Highlight](https://read.readwise.io/read/01j8nd16j2x6kv813wg4djyewg))
- ![](https://scontent-sjc3-1.xx.fbcdn.net/v/t39.2365-6/460924239_3402957093334534_4357083070437107157_n.png?_nc_cat=109&ccb=1-7&_nc_sid=e280be&_nc_ohc=zKTWaIWC3AIQ7kNvgHyLntD&_nc_ht=scontent-sjc3-1.xx&_nc_gid=AVm2pLtxrlmSyKqSiWWXj7V&oh=00_AYDEo5GIIT_OqSYg0P7oDeI76-jjZT4AadSIpVWDYOGGEA&oe=670E8DE0) ([View Highlight](https://read.readwise.io/read/01j8nd19ke2ch8cpd9wqbe3cas))
- ![](https://scontent-sjc3-1.xx.fbcdn.net/v/t39.2365-6/460924239_3402957093334534_4357083070437107157_n.png?_nc_cat=109&ccb=1-7&_nc_sid=e280be&_nc_ohc=zKTWaIWC3AIQ7kNvgHyLntD&_nc_ht=scontent-sjc3-1.xx&_nc_gid=AVm2pLtxrlmSyKqSiWWXj7V&oh=00_AYDEo5GIIT_OqSYg0P7oDeI76-jjZT4AadSIpVWDYOGGEA&oe=670E8DE0) ([View Highlight](https://read.readwise.io/read/01j8nd19nepjqcaam10qszj5j3))
- The full set of releases includes:
  1. Llama CLI (command line interface) to build, configure, and run Llama Stack distributions
  2. Client code in multiple languages, including python, node, kotlin, and swift
  3. Docker containers for Llama Stack Distribution Server and Agents API Provider
  4. Multiple distributions
  1. Single-node Llama Stack Distribution via Meta internal implementation and Ollama
  2. Cloud Llama Stack distributions via AWS, Databricks, Fireworks, and Together
  3. On-device Llama Stack Distribution on iOS implemented via PyTorch ExecuTorch
  4. On-prem Llama Stack Distribution supported by Dell ([View Highlight](https://read.readwise.io/read/01j8nd26vq7ya1szggyvf8j3t6))
- The full set of releases includes:
  1. Llama CLI (command line interface) to build, configure, and run Llama Stack distributions
  2. Client code in multiple languages, including python, node, kotlin, and swift
  3. Docker containers for Llama Stack Distribution Server and Agents API Provider
  4. Multiple distributions
  1. Single-node Llama Stack Distribution via Meta internal implementation and Ollama
  2. Cloud Llama Stack distributions via AWS, Databricks, Fireworks, and Together
  3. On-device Llama Stack Distribution on iOS implemented via PyTorch ExecuTorch
  4. On-prem Llama Stack Distribution supported by Dell
  We look forward to working with developers and partners to simplify all aspects of building with Llama models and welcome feedback.
  ![](https://scontent-sjc3-1.xx.fbcdn.net/v/t39.2365-6/460942153_931942502081982_4461283719059292584_n.png?_nc_cat=108&ccb=1-7&_nc_sid=e280be&_nc_ohc=yPZiTRUpQyIQ7kNvgHhJQmg&_nc_ht=scontent-sjc3-1.xx&_nc_gid=AVm2pLtxrlmSyKqSiWWXj7V&oh=00_AYB-yXvwHvinqABvJ_uC6FdVPwNPmEJgdAbkmGO-0UlN_g&oe=670E9C15)
  System level safety
  Taking an open approach has many benefits. It helps ensure that more people around the world can access the opportunities that AI provides, guards against concentrating power in the hands of a small few, and deploys technology more equitably and safely across society. As we continue to innovate, we also want to make sure we’re empowering developers to build safe and responsible systems.
  Bu ([View Highlight](https://read.readwise.io/read/01j8nd1q526t81fz8rpbjrby0g))
